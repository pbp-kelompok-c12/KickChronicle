<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">

    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            padding: 2em; 
            background-color: #f4f7f9;
            color: #333;
        }

        .datepicker-wrapper {
            display: inline-flex;
            align-items: center;
            padding: 10px 15px;
            background-color: #333333;
            border-radius: 8px;
            border: 1px solid #252323;
            cursor: pointer;
            width: 280px;
        }

        .datepicker-wrapper svg {
            margin-right: 12px;
            stroke: #aaaaaa;
        }

        .datepicker-wrapper input {
            border: none;
            background-color: transparent;
            font-size: 16px;
            outline: none;
            width: 100%;
            color: #cccccc;
        }

        .match { 
            border: 1px solid #dee2e6; 
            padding: 15px; 
            margin-top: 10px; 
            border-radius: 8px; 
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .flatpickr-calendar {
            background-color: #282828 !important;
            border: 1px solid #282828 !important;
            border-radius: 8px;
        }

        .flatpickr-months {
            background-color: #282828 !important;
            border-bottom: 1px solid #282828 !important;
        }

        .flatpickr-month {
            background-color: #282828 !important;
        }

        .flatpickr-current-month {
            color: #fff !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months,
        .flatpickr-current-month .numInput.cur-year {
            background: #282828 !important;
            color: #fff !important;
            font-weight: bold !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months::-ms-expand {
            display: none;
        }

        .flatpickr-prev-month svg, 
        .flatpickr-next-month svg {
            fill: #fff !important;
        }

        .flatpickr-weekdays {
            background-color: #282828 !important;
            border-bottom: 1px solid #282828 !important;
        }

        .flatpickr-weekdaycontainer {
            background-color: #282828 !important;
        }

        .flatpickr-weekday {
            color: #a0a0a0 !important;
            background-color: #282828 !important;
        }

        .flatpickr-day {
            color: #e0e0e0 !important;
        }

        .flatpickr-day.prevMonthDay,
        .flatpickr-day.nextMonthDay {
            color: #555 !important;
        }

        .flatpickr-day.today {
            border-color: #777 !important;
            color: #fff !important;
        }

        .flatpickr-day.today:hover {
            background-color: #3a3a3a !important;
        }

        .flatpickr-day.selected,
        .flatpickr-day.startRange,
        .flatpickr-day.endRange {
            background: #4a4a4a !important;
            border-color: #4a4a4a !important;
            color: #fff !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months {
            background-color: #282828 !important;
            color: #ffffff !important;
            border: none !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months:focus {
            outline: none !important;
            background-color: #3a3a3a !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months option {
            background-color: #282828 !important;
            color: #ffffff !important;
        }

        .flatpickr-current-month .flatpickr-monthDropdown-months option:checked,
        .flatpickr-current-month .flatpickr-monthDropdown-months option:hover {
            background-color: #3a3a3a !important;
            color: #ffffff !important;
        }
    </style>
</head>
<body>

    <div class="datepicker-wrapper">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M8 2V5M16 2V5M3.5 9.09H20.5M21 8.5V17C21 20 19.5 22 16 22H8C4.5 22 3 20 3 17V8.5C3 5.5 4.5 3.5 8 3.5H16C19.5 3.5 21 5.5 21 8.5Z" 
                stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <input type="text" id="datepicker" placeholder="Choose Date">
    </div>

    <div id="match-list" style="margin-top: 2em;"></div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const datepicker = flatpickr("#datepicker", {
                altInput: true,
                altFormat: "l, d F Y",
                dateFormat: "Y-m-d",
                defaultDate: "today",  
                
                onChange: function(selectedDates, dateStr, instance) {
                    const matchListDiv = document.getElementById('match-list');
                    fetch(`/kalender/api/get_matches/?date=${dateStr}`)
                        .then(response => response.json())
                        .then(data => {
                            matchListDiv.innerHTML = ''; 
                            data.matches.forEach(match => {
                                const matchHTML = `
                                    <div class="match">
                                        <p>
                                            <strong>${match.team_1} vs ${match.team_2}</strong>
                                            <br>
                                            <span>Waktu: ${match.start_time}</span>
                                        </p>
                                        <a href="/kalender/export/${match.id}/">Tambah ke Kalender</a>
                                    </div>
                                `;
                                matchListDiv.innerHTML += matchHTML;
                            });
                        });
                }
            });

            const today = datepicker.formatDate(new Date(), "Y-m-d");
            datepicker.setDate(today);
            datepicker.config.onChange([new Date(today)], today, datepicker);
        });
    </script>
</body>
</html>